# Резервное копирование

Данный раздел описывает средства резервного копирования ПО Picodata при
работе в защищенной ОС.

## Копирование распределенной БД  {: #distributed_backup }

Функциональность резервного копирования является неотъемлемой частью
Picodata и реализуется с помощью
[репликации](../overview/glossary.md#replication). Репликация
предполагает наличие копии инстанса Picodata на другом узле для того,
чтобы при выходе из строя основного инстанса хранимые на нём данные не
пострадали и могли быть восстановлены из резервного инстанса. Репликация
задаётся при запуске Picodata вместе с [доменом
отказа](../overview/glossary.md#failure_domain), который следит за тем,
чтобы инстанс и его резервная копия были в разных локациях:

```shell
picodata run --init-replication-factor 2 --failure-domain region=us,zone=us-west-1
```

Фактор репликации 2 означает, что у инстанса будет 1 резервная копия.

Подробнее см. [Репликация и зоны доступности (failure domains)](../tutorial/deploy.md#failure_domains)

## Копирование данных локальной БД  {: #local_backup }

На уровне локального экземпляра Picodata объектами резервного копирования
являются:

- конфигурация СУБД
- конфигурация БД
- программный код СУБД
- процедуры, хранимые в БД <!-- TODO link sql routines doc -->

С точки зрения реализации копирования, эти объекты овеществляются в виде
файлов `*.xlog` / `*.snap` в рабочей директории инстанса. Таким образом,
выполнение задач резервного копирования реализуется через меры,
направленные на сохранение копий рабочих файлов в директории, заданной
при запуске инстанса Picodata.

Например, резервное копирование файлов инстанса может быть выполнено
следующей командой:

```shell
rsync -r /source/path /destination/path
```

где:

- `/source/path` — рабочая директория инстанса
- `/destination/path` — целевая директория для хранения резервной копии

Подробнее см. [документацию ОС Альт 8
СП](https://www.basealt.ru/altsp/docs){:target="_blank"}, Руководство по
комплексу средств защиты, п. 3.6.5. "Пример настройки системы резервного
копирования данных"
